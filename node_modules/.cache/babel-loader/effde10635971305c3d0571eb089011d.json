{"ast":null,"code":"import axios from \"axios\";\nimport jwtDecode from \"jwt-decode\";\nimport { GET_ERRORS, GET_VISITORS, LOGIN_ADMIN, GET_VISITORS_LOGS, TRACK_VISITOR, TRACK_VISITORS } from \"./types\";\nimport { setJwtToken } from \"../securityUtils/SetJwtToken\";\nexport const loginAdmin = (adminCredentials, history) => async dispatch => {\n  try {\n    const res = await axios.post(`/api/v1/admin/login`, adminCredentials); //extract token from res.data\n\n    const {\n      token\n    } = res.data; // store the token in local storage\n\n    localStorage.setItem(\"jwtToken\", token); // set the token in the header using a function defined somewhere else\n\n    setJwtToken(token); // decode token on React side\n\n    const decodedJwtToken = jwtDecode(token);\n    dispatch({\n      type: LOGIN_ADMIN,\n      payload: decodedJwtToken\n    });\n    history.push(\"/dashboard\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const logoutAdmin = () => dispatch => {\n  // When the person logs out, we remove jwt from localStorage as well as the header\n  localStorage.removeItem(\"jwtToken\");\n  setJwtToken(false);\n  dispatch({\n    type: LOGIN_ADMIN,\n    payload: {}\n  });\n  window.location.href = \"/\";\n};\nexport const registerAdmin = (adminCredentials, history) => async dispatch => {\n  try {\n    await axios.post(`/api/v1/admin/register`, adminCredentials);\n    history.push(\"/login\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const registerVisitor = (visitorDetails, history) => async dispatch => {\n  try {\n    await axios.post(`/api/v1/visitors/register-visitor`, visitorDetails);\n    alert(\"visitor successfully registered\");\n    history.push(\"/visitors-log\");\n  } catch (err) {\n    console.log(err.response);\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const fetchVisitors = () => async dispatch => {\n  try {\n    const res = await axios.get(`/api/v1/visitors/registered`);\n    dispatch({\n      type: GET_VISITORS,\n      payload: res.data\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const fetchVisitorsLog = () => async dispatch => {\n  try {\n    const res = await axios.get(`/api/v1/visitors/logs`);\n    dispatch({\n      type: GET_VISITORS_LOGS,\n      payload: res.data\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response\n    });\n  }\n};\nexport const signoutVisitor = (tag, history) => async dispatch => {\n  try {\n    await axios.post(`/api/v1/visitors/logout/${tag}`);\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n    alert(\"visitor successfully signed out\");\n    history.push(\"/visitors-log\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err\n    });\n  }\n};\nexport const trackVisitor = (phone, history) => async dispatch => {\n  try {\n    const res = await axios.get(`/api/v1/visitors/${phone}`);\n    dispatch({\n      type: TRACK_VISITOR,\n      payload: res.data\n    });\n    history.push(\"/tracked-visitor\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const trackVisitors = (dateRange, history) => async dispatch => {\n  try {\n    const res = await axios.post(`/api/v1/visitors/track-visitors`, dateRange);\n    dispatch({\n      type: TRACK_VISITORS,\n      payload: res.data\n    });\n    history.push(\"/tracked-visitors\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err\n    });\n  }\n}; // password reset\n\nexport const forgotPassword = (email, history) => async dispatch => {\n  try {\n    await axios.post(`/api/v1/admin/forgot-password`, email);\n    alert(\"A password reset mail has been sent to your email address\");\n    history.push(\"/\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const resetPassword = (password, history) => async dispatch => {\n  try {\n    await axios.post(`/api/v1/admin/reset-password`, password);\n    alert(\"password reset successful\");\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};","map":{"version":3,"sources":["C:/Users/Unik/Desktop/amalitech/react/amalitech-visitor-management-system.v1/src/actions/adminActions.js"],"names":["axios","jwtDecode","GET_ERRORS","GET_VISITORS","LOGIN_ADMIN","GET_VISITORS_LOGS","TRACK_VISITOR","TRACK_VISITORS","setJwtToken","loginAdmin","adminCredentials","history","dispatch","res","post","token","data","localStorage","setItem","decodedJwtToken","type","payload","push","err","response","logoutAdmin","removeItem","window","location","href","registerAdmin","registerVisitor","visitorDetails","alert","console","log","fetchVisitors","get","fetchVisitorsLog","signoutVisitor","tag","trackVisitor","phone","trackVisitors","dateRange","forgotPassword","email","resetPassword","password"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SACEC,UADF,EAEEC,YAFF,EAGEC,WAHF,EAIEC,iBAJF,EAKEC,aALF,EAMEC,cANF,QAOO,SAPP;AAQA,SAASC,WAAT,QAA4B,8BAA5B;AAEA,OAAO,MAAMC,UAAU,GAAG,CAACC,gBAAD,EAAmBC,OAAnB,KAA+B,MAAOC,QAAP,IAAoB;AAC3E,MAAI;AACF,UAAMC,GAAG,GAAG,MAAMb,KAAK,CAACc,IAAN,CAAY,qBAAZ,EAAkCJ,gBAAlC,CAAlB,CADE,CAGF;;AACA,UAAM;AAAEK,MAAAA;AAAF,QAAYF,GAAG,CAACG,IAAtB,CAJE,CAKF;;AACAC,IAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCH,KAAjC,EANE,CAOF;;AACAP,IAAAA,WAAW,CAACO,KAAD,CAAX,CARE,CASF;;AACA,UAAMI,eAAe,GAAGlB,SAAS,CAACc,KAAD,CAAjC;AACAH,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAEhB,WADC;AAEPiB,MAAAA,OAAO,EAAEF;AAFF,KAAD,CAAR;AAIAR,IAAAA,OAAO,CAACW,IAAR,CAAa,YAAb;AACD,GAhBD,CAgBE,OAAOC,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAvBM;AAyBP,OAAO,MAAMS,WAAW,GAAG,MAAOb,QAAD,IAAc;AAC7C;AACAK,EAAAA,YAAY,CAACS,UAAb,CAAwB,UAAxB;AACAlB,EAAAA,WAAW,CAAC,KAAD,CAAX;AACAI,EAAAA,QAAQ,CAAC;AACPQ,IAAAA,IAAI,EAAEhB,WADC;AAEPiB,IAAAA,OAAO,EAAE;AAFF,GAAD,CAAR;AAIAM,EAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,GAAvB;AACD,CATM;AAWP,OAAO,MAAMC,aAAa,GAAG,CAACpB,gBAAD,EAAmBC,OAAnB,KAA+B,MAC1DC,QAD0D,IAEvD;AACH,MAAI;AACF,UAAMZ,KAAK,CAACc,IAAN,CAAY,wBAAZ,EAAqCJ,gBAArC,CAAN;AACAC,IAAAA,OAAO,CAACW,IAAR,CAAa,QAAb;AACD,GAHD,CAGE,OAAOC,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAZM;AAcP,OAAO,MAAMe,eAAe,GAAG,CAACC,cAAD,EAAiBrB,OAAjB,KAA6B,MAC1DC,QAD0D,IAEvD;AACH,MAAI;AACF,UAAMZ,KAAK,CAACc,IAAN,CAAY,mCAAZ,EAAgDkB,cAAhD,CAAN;AACAC,IAAAA,KAAK,CAAC,iCAAD,CAAL;AACAtB,IAAAA,OAAO,CAACW,IAAR,CAAa,eAAb;AACD,GAJD,CAIE,OAAOC,GAAP,EAAY;AACZW,IAAAA,OAAO,CAACC,GAAR,CAAYZ,GAAG,CAACC,QAAhB;AACAZ,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAdM;AAgBP,OAAO,MAAMoB,aAAa,GAAG,MAAM,MAAOxB,QAAP,IAAoB;AACrD,MAAI;AACF,UAAMC,GAAG,GAAG,MAAMb,KAAK,CAACqC,GAAN,CAAW,6BAAX,CAAlB;AAEAzB,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAEjB,YADC;AAEPkB,MAAAA,OAAO,EAAER,GAAG,CAACG;AAFN,KAAD,CAAR;AAID,GAPD,CAOE,OAAOO,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAdM;AAgBP,OAAO,MAAMsB,gBAAgB,GAAG,MAAM,MAAO1B,QAAP,IAAoB;AACxD,MAAI;AACF,UAAMC,GAAG,GAAG,MAAMb,KAAK,CAACqC,GAAN,CAAW,uBAAX,CAAlB;AACAzB,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAEf,iBADC;AAEPgB,MAAAA,OAAO,EAAER,GAAG,CAACG;AAFN,KAAD,CAAR;AAID,GAND,CAME,OAAOO,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC;AAFN,KAAD,CAAR;AAID;AACF,CAbM;AAeP,OAAO,MAAMe,cAAc,GAAG,CAACC,GAAD,EAAM7B,OAAN,KAAkB,MAAOC,QAAP,IAAoB;AAClE,MAAI;AACF,UAAMZ,KAAK,CAACc,IAAN,CAAY,2BAA0B0B,GAAI,EAA1C,CAAN;AACA5B,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAE;AAFF,KAAD,CAAR;AAIAY,IAAAA,KAAK,CAAC,iCAAD,CAAL;AACAtB,IAAAA,OAAO,CAACW,IAAR,CAAa,eAAb;AACD,GARD,CAQE,OAAOC,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE;AAFF,KAAD,CAAR;AAID;AACF,CAfM;AAiBP,OAAO,MAAMkB,YAAY,GAAG,CAACC,KAAD,EAAQ/B,OAAR,KAAoB,MAAOC,QAAP,IAAoB;AAClE,MAAI;AACF,UAAMC,GAAG,GAAG,MAAMb,KAAK,CAACqC,GAAN,CAAW,oBAAmBK,KAAM,EAApC,CAAlB;AACA9B,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAEd,aADC;AAEPe,MAAAA,OAAO,EAAER,GAAG,CAACG;AAFN,KAAD,CAAR;AAIAL,IAAAA,OAAO,CAACW,IAAR,CAAa,kBAAb;AACD,GAPD,CAOE,OAAOC,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAdM;AAgBP,OAAO,MAAM2B,aAAa,GAAG,CAACC,SAAD,EAAYjC,OAAZ,KAAwB,MAAOC,QAAP,IAAoB;AACvE,MAAI;AACF,UAAMC,GAAG,GAAG,MAAMb,KAAK,CAACc,IAAN,CAAY,iCAAZ,EAA8C8B,SAA9C,CAAlB;AACAhC,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAEb,cADC;AAEPc,MAAAA,OAAO,EAAER,GAAG,CAACG;AAFN,KAAD,CAAR;AAIAL,IAAAA,OAAO,CAACW,IAAR,CAAa,mBAAb;AACD,GAPD,CAOE,OAAOC,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE;AAFF,KAAD,CAAR;AAID;AACF,CAdM,C,CAgBP;;AAEA,OAAO,MAAMsB,cAAc,GAAG,CAACC,KAAD,EAAQnC,OAAR,KAAoB,MAAOC,QAAP,IAAoB;AACpE,MAAI;AACF,UAAMZ,KAAK,CAACc,IAAN,CAAY,+BAAZ,EAA4CgC,KAA5C,CAAN;AACAb,IAAAA,KAAK,CAAC,2DAAD,CAAL;AACAtB,IAAAA,OAAO,CAACW,IAAR,CAAa,GAAb;AACAV,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAE;AAFF,KAAD,CAAR;AAID,GARD,CAQE,OAAOE,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAfM;AAiBP,OAAO,MAAM+B,aAAa,GAAG,CAACC,QAAD,EAAWrC,OAAX,KAAuB,MAAOC,QAAP,IAAoB;AACtE,MAAI;AACF,UAAMZ,KAAK,CAACc,IAAN,CAAY,8BAAZ,EAA2CkC,QAA3C,CAAN;AACAf,IAAAA,KAAK,CAAC,2BAAD,CAAL;AACAtB,IAAAA,OAAO,CAACW,IAAR,CAAa,QAAb;AACAV,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAE;AAFF,KAAD,CAAR;AAID,GARD,CAQE,OAAOE,GAAP,EAAY;AACZX,IAAAA,QAAQ,CAAC;AACPQ,MAAAA,IAAI,EAAElB,UADC;AAEPmB,MAAAA,OAAO,EAAEE,GAAG,CAACC,QAAJ,CAAaR;AAFf,KAAD,CAAR;AAID;AACF,CAfM","sourcesContent":["import axios from \"axios\";\nimport jwtDecode from \"jwt-decode\";\nimport {\n  GET_ERRORS,\n  GET_VISITORS,\n  LOGIN_ADMIN,\n  GET_VISITORS_LOGS,\n  TRACK_VISITOR,\n  TRACK_VISITORS,\n} from \"./types\";\nimport { setJwtToken } from \"../securityUtils/SetJwtToken\";\n\nexport const loginAdmin = (adminCredentials, history) => async (dispatch) => {\n  try {\n    const res = await axios.post(`/api/v1/admin/login`, adminCredentials);\n\n    //extract token from res.data\n    const { token } = res.data;\n    // store the token in local storage\n    localStorage.setItem(\"jwtToken\", token);\n    // set the token in the header using a function defined somewhere else\n    setJwtToken(token);\n    // decode token on React side\n    const decodedJwtToken = jwtDecode(token);\n    dispatch({\n      type: LOGIN_ADMIN,\n      payload: decodedJwtToken,\n    });\n    history.push(\"/dashboard\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n\nexport const logoutAdmin = () => (dispatch) => {\n  // When the person logs out, we remove jwt from localStorage as well as the header\n  localStorage.removeItem(\"jwtToken\");\n  setJwtToken(false);\n  dispatch({\n    type: LOGIN_ADMIN,\n    payload: {},\n  });\n  window.location.href = \"/\";\n};\n\nexport const registerAdmin = (adminCredentials, history) => async (\n  dispatch\n) => {\n  try {\n    await axios.post(`/api/v1/admin/register`, adminCredentials);\n    history.push(\"/login\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n\nexport const registerVisitor = (visitorDetails, history) => async (\n  dispatch\n) => {\n  try {\n    await axios.post(`/api/v1/visitors/register-visitor`, visitorDetails);\n    alert(\"visitor successfully registered\");\n    history.push(\"/visitors-log\");\n  } catch (err) {\n    console.log(err.response);\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n\nexport const fetchVisitors = () => async (dispatch) => {\n  try {\n    const res = await axios.get(`/api/v1/visitors/registered`);\n\n    dispatch({\n      type: GET_VISITORS,\n      payload: res.data,\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n\nexport const fetchVisitorsLog = () => async (dispatch) => {\n  try {\n    const res = await axios.get(`/api/v1/visitors/logs`);\n    dispatch({\n      type: GET_VISITORS_LOGS,\n      payload: res.data,\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response,\n    });\n  }\n};\n\nexport const signoutVisitor = (tag, history) => async (dispatch) => {\n  try {\n    await axios.post(`/api/v1/visitors/logout/${tag}`);\n    dispatch({\n      type: GET_ERRORS,\n      payload: {},\n    });\n    alert(\"visitor successfully signed out\");\n    history.push(\"/visitors-log\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err,\n    });\n  }\n};\n\nexport const trackVisitor = (phone, history) => async (dispatch) => {\n  try {\n    const res = await axios.get(`/api/v1/visitors/${phone}`);\n    dispatch({\n      type: TRACK_VISITOR,\n      payload: res.data,\n    });\n    history.push(\"/tracked-visitor\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n\nexport const trackVisitors = (dateRange, history) => async (dispatch) => {\n  try {\n    const res = await axios.post(`/api/v1/visitors/track-visitors`, dateRange);\n    dispatch({\n      type: TRACK_VISITORS,\n      payload: res.data,\n    });\n    history.push(\"/tracked-visitors\");\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err,\n    });\n  }\n};\n\n// password reset\n\nexport const forgotPassword = (email, history) => async (dispatch) => {\n  try {\n    await axios.post(`/api/v1/admin/forgot-password`, email);\n    alert(\"A password reset mail has been sent to your email address\");\n    history.push(\"/\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {},\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n\nexport const resetPassword = (password, history) => async (dispatch) => {\n  try {\n    await axios.post(`/api/v1/admin/reset-password`, password);\n    alert(\"password reset successful\");\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {},\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data,\n    });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}